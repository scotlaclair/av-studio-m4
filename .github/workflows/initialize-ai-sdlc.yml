name: Initialize AI-First SDLC

on:
  workflow_dispatch:
    inputs:
      create_labels:
        description: 'Create all project labels'
        type: boolean
        default: true
      create_issues:
        description: 'Create all task issues'
        type: boolean
        default: true
      phase:
        description: 'Which phase to create (all, 1, 2, 3, 4, 5, 6, 7)'
        type: string
        default: 'all'

env:
  PROJECT_NUMBER: 2
  PROJECT_OWNER: scotlaclair
  GH_TOKEN: ${{ secrets.AUTOMATION_TOKEN }}

jobs:
  setup-labels:
    if: ${{ inputs.create_labels }}
    runs-on: ubuntu-latest
    steps:
      - name: Create all labels
        uses: actions/github-script@v7
        with:
          github-token: ${{ env.GH_TOKEN }}
          script: |
            const labels = [
              // Priority
              { name: 'P0-critical', color: 'B60205', description: 'Critical - blocks release' },
              { name: 'P1-high', color: 'D93F0B', description: 'High priority' },
              { name: 'P2-medium', color: 'FBCA04', description: 'Medium priority' },
              { name: 'P3-low', color: '0E8A16', description: 'Low priority' },
              // Type
              { name: 'type:feature', color: '1D76DB', description: 'New feature' },
              { name: 'type:infra', color: '5319E7', description: 'Infrastructure' },
              { name: 'type:docs', color: '0075CA', description: 'Documentation' },
              { name: 'type:test', color: 'BFD4F2', description: 'Testing' },
              { name: 'type:security', color: 'B60205', description: 'Security' },
              // Phase
              { name: 'phase:1-foundation', color: 'C2E0C6', description: 'Phase 1: Foundation' },
              { name: 'phase:2-gateway', color: 'BFDADC', description: 'Phase 2: Gateway Layer' },
              { name: 'phase:3-llm', color: 'D4C5F9', description: 'Phase 3: LLM Integration' },
              { name: 'phase:4-audio', color: 'FEF2C0', description: 'Phase 4: Audio Processing' },
              { name: 'phase:5-agents', color: 'F9D0C4', description: 'Phase 5: Agent System' },
              { name: 'phase:6-api', color: 'C5DEF5', description: 'Phase 6: API Layer' },
              { name: 'phase:7-mcp', color: 'E6E6FA', description: 'Phase 7: MCP Server' },
              // Agent
              { name: 'agent:coder', color: 'FBEF79', description: 'Coder Agent (Copilot/Codex)' },
              { name: 'agent:reviewer', color: 'F9D0C4', description: 'Reviewer Agent' },
              { name: 'agent:security', color: 'E99695', description: 'Security Agent' },
              { name: 'agent:docs', color: 'C5DEF5', description: 'Documentation Agent' },
              { name: 'agent:orchestrator', color: 'D4C5F9', description: 'Orchestrator Agent' },
              // Gate
              { name: 'gate:blocked', color: 'B60205', description: 'Blocked at gate' },
              { name: 'gate:human-required', color: 'D93F0B', description: 'Human approval needed' },
              { name: 'gate:passed', color: '0E8A16', description: 'Gate passed' },
              { name: 'gate:pending', color: 'FBCA04', description: 'Gate pending review' },
              // State
              { name: 'state:intake', color: 'EEEEEE', description: 'ðŸ“¥ Intake' },
              { name: 'state:specify', color: '1D76DB', description: 'ðŸ“‹ Specify' },
              { name: 'state:plan', color: '5319E7', description: 'ðŸ—ï¸ Plan' },
              { name: 'state:decompose', color: '5319E7', description: 'ðŸ§© Decompose' },
              { name: 'state:implement', color: 'FBCA04', description: 'ðŸ’» Implement' },
              { name: 'state:verify', color: 'FBCA04', description: 'âœ… Verify' },
              { name: 'state:review', color: 'D93F0B', description: 'ðŸ” Review' },
              { name: 'state:integrate', color: 'D93F0B', description: 'ðŸ”— Integrate' },
              { name: 'state:document', color: '0E8A16', description: 'ðŸ“š Document' },
              { name: 'state:harden', color: 'B60205', description: 'ðŸ”’ Harden' },
              { name: 'state:release', color: '0E8A16', description: 'ðŸš€ Release' },
              { name: 'state:learn', color: '0E8A16', description: 'ðŸ“Š Learn' },
            ];
            
            for (const label of labels) {
              try {
                await github.rest.issues.createLabel({
                  owner: context.repo.owner,
                  repo: context.repo.repo,
                  ...label
                });
                console.log(`âœ… Created: ${label.name}`);
              } catch (e) {
                if (e.status === 422) {
                  console.log(`â­ï¸ Exists: ${label.name}`);
                } else {
                  console.error(`âŒ Failed: ${label.name}`, e.message);
                }
              }
            }

  create-dev-branch:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
        with:
          token: ${{ env.GH_TOKEN }}
      - name: Create dev branch
        run: |
          git config user.name "github-actions[bot]"
          git config user.email "github-actions[bot]@users.noreply.github.com"
          git checkout -b dev 2>/dev/null || git checkout dev
          git push origin dev -u || echo "Branch already exists"

  create-issues:
    if: ${{ inputs.create_issues }}
    needs: [setup-labels, create-dev-branch]
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Create All Task Issues
        uses: actions/github-script@v7
        with:
          github-token: ${{ env.GH_TOKEN }}
          script: |
            const phase = '${{ inputs.phase }}';
            
            // ============================================================
            // COMPLETE TASK DEFINITIONS FROM SPEC-KIT
            // ============================================================
            
            const allTasks = [
              // ==================== PHASE 1: FOUNDATION ====================
              {
                id: 'INFRA-001',
                title: '[INFRA-001] Initialize repository structure',
                phase: '1',
                priority: 'P0-critical',
                type: 'type:infra',
                estimate: 2,
                dependencies: [],
                body: `## Task: INFRA-001 - Initialize repository structure

**Phase:** 1 - Foundation | **Priority:** P0-critical | **Estimate:** 2 hours  
**Dependencies:** None

---

### Description
Set up the initial repository structure per \`spec-kit_tasks.md\` and \`av_studio_project_structure.txt\`.

### Acceptance Criteria
- [ ] pyproject.toml with all dependencies (torch, mlx, demucs, fastapi, etc.)
- [ ] src/av_studio/ package structure created with __init__.py
- [ ] .github/workflows/ directory created
- [ ] spec-kit/ directory with constitution.md, spec.md, plan.md, tasks.md
- [ ] .env.example with all required environment variables
- [ ] Updated README.md with project overview

### Files to Create
\`\`\`
pyproject.toml
src/av_studio/__init__.py
src/av_studio/py.typed
src/av_studio/config/__init__.py
src/av_studio/gateway/__init__.py
src/av_studio/llm/__init__.py
src/av_studio/processing/__init__.py
src/av_studio/processing/audio/__init__.py
src/av_studio/agents/__init__.py
src/av_studio/mcp/__init__.py
src/av_studio/api/__init__.py
.env.example
\`\`\`

### Technical Notes
- Use Python 3.12
- Configure for Apple Silicon / M4 Max optimization
- Include dev dependencies (pytest, ruff, mypy)

---

**ðŸ¤– Agent:** @copilot - Implement on \`dev\` branch, create PR when complete.  
**ðŸ“‹ Spec Reference:** [spec-kit_tasks.md](../blob/main/spec-kit_tasks.md)`
              },
              {
                id: 'INFRA-002',
                title: '[INFRA-002] Configure CI/CD pipelines',
                phase: '1',
                priority: 'P0-critical',
                type: 'type:infra',
                estimate: 4,
                dependencies: ['INFRA-001'],
                body: `## Task: INFRA-002 - Configure CI/CD pipelines

**Phase:** 1 - Foundation | **Priority:** P0-critical | **Estimate:** 4 hours  
**Dependencies:** INFRA-001

---

### Description
Set up GitHub Actions workflows for automated testing, linting, type checking, and security scanning.

### Acceptance Criteria
- [ ] Lint workflow (ruff) runs on all PRs
- [ ] Test workflow (pytest) runs on all PRs
- [ ] Type check workflow (mypy) runs on all PRs
- [ ] Security scan workflow (bandit, safety) runs on all PRs
- [ ] All workflows block merge on failure

### Files to Create
\`\`\`yaml
.github/workflows/lint.yml
.github/workflows/test.yml  
.github/workflows/typecheck.yml
.github/workflows/security.yml
\`\`\`

### Workflow Requirements
- Use Python 3.12
- Cache pip dependencies
- Run on ubuntu-latest
- Trigger on: push to dev/main, PR to dev/main

---

**ðŸ¤– Agent:** @copilot - Implement on \`dev\` branch  
**ðŸ“‹ Spec Reference:** [spec-kit_tasks.md](../blob/main/spec-kit_tasks.md)`
              },
              {
                id: 'INFRA-003',
                title: '[INFRA-003] Setup development environment scripts',
                phase: '1',
                priority: 'P1-high',
                type: 'type:infra',
                estimate: 2,
                dependencies: ['INFRA-001'],
                body: `## Task: INFRA-003 - Setup development environment scripts

**Phase:** 1 - Foundation | **Priority:** P1-high | **Estimate:** 2 hours  
**Dependencies:** INFRA-001

---

### Description
Create setup scripts for local development environment initialization.

### Acceptance Criteria
- [ ] setup.sh installs all Python dependencies
- [ ] Creates required local directories (~/.av-studio/)
- [ ] Downloads default MLX models
- [ ] Verifies MPS GPU availability
- [ ] Provides clear success/failure output

### Files to Create
\`\`\`
scripts/setup.sh
scripts/verify_gpu.py
scripts/download_models.py
\`\`\`

---

**ðŸ¤– Agent:** @copilot - Implement on \`dev\` branch  
**ðŸ“‹ Spec Reference:** [spec-kit_tasks.md](../blob/main/spec-kit_tasks.md)`
              },
              {
                id: 'CFG-001',
                title: '[CFG-001] Implement settings module with Pydantic',
                phase: '1',
                priority: 'P0-critical',
                type: 'type:feature',
                estimate: 3,
                dependencies: ['INFRA-001'],
                body: `## Task: CFG-001 - Implement settings module with Pydantic

**Phase:** 1 - Foundation | **Priority:** P0-critical | **Estimate:** 3 hours  
**Dependencies:** INFRA-001

---

### Description
Create a centralized configuration system using Pydantic Settings for type-safe configuration management.

### Acceptance Criteria
- [ ] All settings defined with types and defaults
- [ ] Environment variable loading works (.env support)
- [ ] Validation for paths, URLs, numeric limits
- [ ] Settings singleton accessible globally
- [ ] Separate configs for: app, LLM, processing, external APIs

### Files to Create
\`\`\`
src/av_studio/config/__init__.py
src/av_studio/config/settings.py
\`\`\`

### Technical Specification
Reference implementation in: \`av_studio_config_settings.py\`

Key settings to include:
- Application paths (base_dir, media_dir, models_dir, cache_dir)
- Ollama configuration (base_url, default_model)
- MLX configuration (default_model, max_tokens)
- External API keys (OpenAI, Anthropic, Google, ElevenLabs)
- Processing settings (use_mps, use_mlx, max_concurrent_jobs)
- Router defaults (cost_threshold, latency_threshold)

### Tests Required
\`\`\`
tests/config/test_settings.py
\`\`\`

---

**ðŸ¤– Agent:** @copilot - Implement on \`dev\` branch  
**ðŸ“‹ Spec Reference:** [spec-kit_tasks.md](../blob/main/spec-kit_tasks.md)`
              },
              {
                id: 'CFG-002',
                title: '[CFG-002] Create model configuration registry',
                phase: '1',
                priority: 'P0-critical',
                type: 'type:feature',
                estimate: 2,
                dependencies: ['CFG-001'],
                body: `## Task: CFG-002 - Create model configuration registry

**Phase:** 1 - Foundation | **Priority:** P0-critical | **Estimate:** 2 hours  
**Dependencies:** CFG-001

---

### Description
Create a YAML-based model configuration system that defines available LLM models, their capabilities, and routing metadata.

### Acceptance Criteria
- [ ] YAML-based model definitions
- [ ] Model capabilities defined (supported tasks, context length, pricing)
- [ ] Runtime model registry with fast lookup
- [ ] Support for local (MLX, Ollama) and external (OpenAI, Claude, Gemini) models

### Files to Create
\`\`\`
config/models.yaml
src/av_studio/config/models.py
tests/config/test_models.py
\`\`\`

### Model Registry Fields
\`\`\`yaml
models:
  ollama-llama3.2:
    provider: ollama
    model_id: llama3.2:8b
    supports: [chat, code, summarization]
    max_context: 128000
    cost_per_1k_input: 0.0
    cost_per_1k_output: 0.0
    is_local: true
\`\`\`

---

**ðŸ¤– Agent:** @copilot - Implement on \`dev\` branch  
**ðŸ“‹ Spec Reference:** [spec-kit_tasks.md](../blob/main/spec-kit_tasks.md)`
              },
              {
                id: 'CFG-003',
                title: '[CFG-003] Implement pricing configuration',
                phase: '1',
                priority: 'P1-high',
                type: 'type:feature',
                estimate: 1,
                dependencies: ['CFG-001'],
                body: `## Task: CFG-003 - Implement pricing configuration

**Phase:** 1 - Foundation | **Priority:** P1-high | **Estimate:** 1 hour  
**Dependencies:** CFG-001

---

### Description
Create YAML-based pricing configuration for LLM API cost tracking.

### Acceptance Criteria
- [ ] YAML-based pricing definitions
- [ ] Per-model input/output token rates
- [ ] Easy to update when API prices change
- [ ] Support for tiered pricing

### Files to Create
\`\`\`
config/pricing.yaml
src/av_studio/config/pricing.py
\`\`\`

---

**ðŸ¤– Agent:** @copilot - Implement on \`dev\` branch  
**ðŸ“‹ Spec Reference:** [spec-kit_tasks.md](../blob/main/spec-kit_tasks.md)`
              },

              // ==================== PHASE 2: GATEWAY LAYER ====================
              {
                id: 'GW-001',
                title: '[GW-001] Implement token analyzer',
                phase: '2',
                priority: 'P0-critical',
                type: 'type:feature',
                estimate: 4,
                dependencies: ['CFG-002'],
                body: `## Task: GW-001 - Implement token analyzer

**Phase:** 2 - Gateway | **Priority:** P0-critical | **Estimate:** 4 hours  
**Dependencies:** CFG-002

---

### Description
Create a token counting system that accurately estimates token usage for various LLM providers.

### Acceptance Criteria
- [ ] Tiktoken integration for OpenAI/GPT models
- [ ] Llama tokenizer for local models
- [ ] Accurate count within 5% of actual usage
- [ ] Support for chat message format (role + content)
- [ ] Caching for repeated tokenization

### Files to Create
\`\`\`
src/av_studio/gateway/__init__.py
src/av_studio/gateway/token_analyzer.py
tests/gateway/test_token_analyzer.py
\`\`\`

### Reference Implementation
See: \`av_studio_src_gateway_token_analyzer.py\`

---

**ðŸ¤– Agent:** @copilot - Implement on \`dev\` branch  
**ðŸ“‹ Spec Reference:** [spec-kit_tasks.md](../blob/main/spec-kit_tasks.md)`
              },
              {
                id: 'GW-002',
                title: '[GW-002] Implement cost calculator',
                phase: '2',
                priority: 'P0-critical',
                type: 'type:feature',
                estimate: 3,
                dependencies: ['GW-001', 'CFG-003'],
                body: `## Task: GW-002 - Implement cost calculator

**Phase:** 2 - Gateway | **Priority:** P0-critical | **Estimate:** 3 hours  
**Dependencies:** GW-001, CFG-003

---

### Description
Create a cost calculation and tracking system for LLM API usage.

### Acceptance Criteria
- [ ] Accurate cost estimation before request
- [ ] Running total tracking across session
- [ ] Budget limit enforcement with alerts
- [ ] Cost summary reporting (by model, by time period)
- [ ] Support for daily/monthly budget limits

### Files to Create
\`\`\`
src/av_studio/gateway/cost_calculator.py
tests/gateway/test_cost_calculator.py
\`\`\`

---

**ðŸ¤– Agent:** @copilot - Implement on \`dev\` branch  
**ðŸ“‹ Spec Reference:** [spec-kit_tasks.md](../blob/main/spec-kit_tasks.md)`
              },
              {
                id: 'GW-003',
                title: '[GW-003] Implement smart router',
                phase: '2',
                priority: 'P0-critical',
                type: 'type:feature',
                estimate: 6,
                dependencies: ['GW-001', 'GW-002', 'CFG-002'],
                body: `## Task: GW-003 - Implement smart router

**Phase:** 2 - Gateway | **Priority:** P0-critical | **Estimate:** 6 hours  
**Dependencies:** GW-001, GW-002, CFG-002

---

### Description
Create an intelligent routing system that selects the optimal LLM based on task type, cost constraints, latency requirements, and quality needs.

### Acceptance Criteria
- [ ] Routes based on task type (chat, code, creative, etc.)
- [ ] Respects cost constraints and budget limits
- [ ] Considers latency requirements
- [ ] Quality scoring for model selection
- [ ] Local-first preference honored
- [ ] Fallback chain when primary unavailable
- [ ] Latency tracking and adaptive routing
- [ ] All routing decisions logged

### Files to Create
\`\`\`
src/av_studio/gateway/router.py
tests/gateway/test_router.py
\`\`\`

### Reference Implementation
See: \`av_studio_src_gateway_router.py\`

---

**ðŸ¤– Agent:** @copilot - Implement on \`dev\` branch  
**ðŸ“‹ Spec Reference:** [spec-kit_tasks.md](../blob/main/spec-kit_tasks.md)`
              },
              {
                id: 'GW-004',
                title: '[GW-004] Implement authentication middleware',
                phase: '2',
                priority: 'P1-high',
                type: 'type:feature',
                estimate: 3,
                dependencies: ['INFRA-001'],
                body: `## Task: GW-004 - Implement authentication middleware

**Phase:** 2 - Gateway | **Priority:** P1-high | **Estimate:** 3 hours  
**Dependencies:** INFRA-001

---

### Description
Create authentication middleware for the API gateway.

### Acceptance Criteria
- [ ] API key validation
- [ ] JWT token support for sessions
- [ ] Rate limiting per API key
- [ ] Proper 401/403 responses
- [ ] Secure key storage (environment variables)

### Files to Create
\`\`\`
src/av_studio/gateway/auth.py
tests/gateway/test_auth.py
\`\`\`

---

**ðŸ¤– Agent:** @copilot - Implement on \`dev\` branch  
**ðŸ“‹ Spec Reference:** [spec-kit_tasks.md](../blob/main/spec-kit_tasks.md)`
              },
              {
                id: 'GW-005',
                title: '[GW-005] Implement rate limiter',
                phase: '2',
                priority: 'P1-high',
                type: 'type:feature',
                estimate: 2,
                dependencies: ['GW-004'],
                body: `## Task: GW-005 - Implement rate limiter

**Phase:** 2 - Gateway | **Priority:** P1-high | **Estimate:** 2 hours  
**Dependencies:** GW-004

---

### Description
Create a rate limiting system for API endpoints.

### Acceptance Criteria
- [ ] Configurable limits per endpoint
- [ ] Token bucket algorithm implementation
- [ ] Returns 429 with Retry-After header
- [ ] Per-client tracking

### Files to Create
\`\`\`
src/av_studio/gateway/rate_limiter.py
tests/gateway/test_rate_limiter.py
\`\`\`

---

**ðŸ¤– Agent:** @copilot - Implement on \`dev\` branch  
**ðŸ“‹ Spec Reference:** [spec-kit_tasks.md](../blob/main/spec-kit_tasks.md)`
              },

              // ==================== PHASE 3: LLM INTEGRATION ====================
              {
                id: 'LLM-001',
                title: '[LLM-001] Implement MLX client',
                phase: '3',
                priority: 'P0-critical',
                type: 'type:feature',
                estimate: 6,
                dependencies: ['CFG-001'],
                body: `## Task: LLM-001 - Implement MLX client

**Phase:** 3 - LLM Integration | **Priority:** P0-critical | **Estimate:** 6 hours  
**Dependencies:** CFG-001

---

### Description
Create a high-performance LLM client using Apple's MLX framework, optimized for M4 Max.

### Acceptance Criteria
- [ ] Load MLX models from HuggingFace
- [ ] Generate completions with <50ms first-token latency
- [ ] Streaming token generation support
- [ ] Memory management (unload models when switching)
- [ ] Proper prompt formatting for chat (Llama-style)
- [ ] Model info and status reporting

### Files to Create
\`\`\`
src/av_studio/llm/__init__.py
src/av_studio/llm/mlx_client.py
tests/llm/test_mlx_client.py
\`\`\`

### Reference Implementation
See: \`av_studio_src_llm_mlx_client.py\`

### Recommended Models
- Fast: mlx-community/Llama-3.2-3B-Instruct-4bit
- Balanced: mlx-community/Llama-3.2-8B-Instruct-4bit
- Code: mlx-community/Qwen2.5-Coder-7B-Instruct-4bit

---

**ðŸ¤– Agent:** @copilot - Implement on \`dev\` branch  
**ðŸ“‹ Spec Reference:** [spec-kit_tasks.md](../blob/main/spec-kit_tasks.md)`
              },
              {
                id: 'LLM-002',
                title: '[LLM-002] Implement Ollama client',
                phase: '3',
                priority: 'P0-critical',
                type: 'type:feature',
                estimate: 3,
                dependencies: ['CFG-001'],
                body: `## Task: LLM-002 - Implement Ollama client

**Phase:** 3 - LLM Integration | **Priority:** P0-critical | **Estimate:** 3 hours  
**Dependencies:** CFG-001

---

### Description
Create an Ollama client for local LLM inference as an alternative/fallback to MLX.

### Acceptance Criteria
- [ ] Connect to local Ollama server
- [ ] List available models
- [ ] Chat completions API
- [ ] Streaming support
- [ ] Error handling for server unavailable

### Files to Create
\`\`\`
src/av_studio/llm/ollama_client.py
tests/llm/test_ollama_client.py
\`\`\`

---

**ðŸ¤– Agent:** @copilot - Implement on \`dev\` branch  
**ðŸ“‹ Spec Reference:** [spec-kit_tasks.md](../blob/main/spec-kit_tasks.md)`
              },
              {
                id: 'LLM-003',
                title: '[LLM-003] Implement external API clients',
                phase: '3',
                priority: 'P0-critical',
                type: 'type:feature',
                estimate: 4,
                dependencies: ['CFG-001', 'GW-002'],
                body: `## Task: LLM-003 - Implement external API clients

**Phase:** 3 - LLM Integration | **Priority:** P0-critical | **Estimate:** 4 hours  
**Dependencies:** CFG-001, GW-002

---

### Description
Create clients for external LLM APIs (OpenAI, Anthropic, Google).

### Acceptance Criteria
- [ ] OpenAI client with GPT-4o, GPT-4o-mini support
- [ ] Anthropic client with Claude 3.5 Sonnet/Haiku
- [ ] Google client with Gemini 2.0 Flash/Pro
- [ ] Unified interface across providers
- [ ] Cost tracking integration
- [ ] Streaming support for all

### Files to Create
\`\`\`
src/av_studio/llm/external_clients.py
tests/llm/test_external_clients.py
\`\`\`

---

**ðŸ¤– Agent:** @copilot - Implement on \`dev\` branch  
**ðŸ“‹ Spec Reference:** [spec-kit_tasks.md](../blob/main/spec-kit_tasks.md)`
              },
              {
                id: 'LLM-004',
                title: '[LLM-004] Implement unified LLM interface',
                phase: '3',
                priority: 'P0-critical',
                type: 'type:feature',
                estimate: 3,
                dependencies: ['LLM-001', 'LLM-002', 'LLM-003', 'GW-003'],
                body: `## Task: LLM-004 - Implement unified LLM interface

**Phase:** 3 - LLM Integration | **Priority:** P0-critical | **Estimate:** 3 hours  
**Dependencies:** LLM-001, LLM-002, LLM-003, GW-003

---

### Description
Create a unified interface that abstracts all LLM backends and integrates with the smart router.

### Acceptance Criteria
- [ ] Single interface for all LLM backends
- [ ] Automatic routing via smart router
- [ ] Consistent response format across providers
- [ ] Error handling and automatic retries
- [ ] Fallback to local models on external failure

### Files to Create
\`\`\`
src/av_studio/llm/unified.py
tests/llm/test_unified.py
\`\`\`

---

**ðŸ¤– Agent:** @copilot - Implement on \`dev\` branch  
**ðŸ“‹ Spec Reference:** [spec-kit_tasks.md](../blob/main/spec-kit_tasks.md)`
              },

              // ==================== PHASE 4: AUDIO PROCESSING ====================
              {
                id: 'AUD-001',
                title: '[AUD-001] Implement Demucs stem separation',
                phase: '4',
                priority: 'P0-critical',
                type: 'type:feature',
                estimate: 6,
                dependencies: ['INFRA-001'],
                body: `## Task: AUD-001 - Implement Demucs stem separation

**Phase:** 4 - Audio Processing | **Priority:** P0-critical | **Estimate:** 6 hours  
**Dependencies:** INFRA-001

---

### Description
Implement audio stem separation using Demucs with MPS GPU acceleration.

### Acceptance Criteria
- [ ] Separate audio into: vocals, drums, bass, other
- [ ] MPS (Metal) GPU acceleration working
- [ ] Support htdemucs, htdemucs_ft, mdx_extra models
- [ ] Progress callback for UI updates
- [ ] Output to configured directory structure
- [ ] <30 seconds for 3-minute song on M4 Max

### Files to Create
\`\`\`
src/av_studio/processing/__init__.py
src/av_studio/processing/audio/__init__.py
src/av_studio/processing/audio/demucs_processor.py
tests/processing/audio/test_demucs.py
\`\`\`

### Reference Implementation
See: \`av_studio_src_processing_audio_pipeline.py\`

---

**ðŸ¤– Agent:** @copilot - Implement on \`dev\` branch  
**ðŸ“‹ Spec Reference:** [spec-kit_tasks.md](../blob/main/spec-kit_tasks.md)`
              },
              {
                id: 'AUD-002',
                title: '[AUD-002] Implement Whisper transcription',
                phase: '4',
                priority: 'P0-critical',
                type: 'type:feature',
                estimate: 4,
                dependencies: ['INFRA-001'],
                body: `## Task: AUD-002 - Implement Whisper transcription

**Phase:** 4 - Audio Processing | **Priority:** P0-critical | **Estimate:** 4 hours  
**Dependencies:** INFRA-001

---

### Description
Implement audio transcription using faster-whisper.

### Acceptance Criteria
- [ ] Transcribe audio with word-level timestamps
- [ ] Support all Whisper model sizes (tiny â†’ large-v3)
- [ ] Language detection or manual specification
- [ ] VAD filtering for improved accuracy
- [ ] >95% accuracy on clear speech
- [ ] <10 seconds for 1-minute audio

### Files to Create
\`\`\`
src/av_studio/processing/audio/whisper_processor.py
tests/processing/audio/test_whisper.py
\`\`\`

---

**ðŸ¤– Agent:** @copilot - Implement on \`dev\` branch  
**ðŸ“‹ Spec Reference:** [spec-kit_tasks.md](../blob/main/spec-kit_tasks.md)`
              },
              {
                id: 'AUD-003',
                title: '[AUD-003] Implement audio effects pipeline',
                phase: '4',
                priority: 'P1-high',
                type: 'type:feature',
                estimate: 4,
                dependencies: ['INFRA-001'],
                body: `## Task: AUD-003 - Implement audio effects pipeline

**Phase:** 4 - Audio Processing | **Priority:** P1-high | **Estimate:** 4 hours  
**Dependencies:** INFRA-001

---

### Description
Implement audio effects processing using Pedalboard.

### Acceptance Criteria
- [ ] Pedalboard integration
- [ ] Effects: reverb, compression, EQ, gain, filters
- [ ] Effect chain composition
- [ ] Preset system for common setups
- [ ] Real-time preview capability

### Files to Create
\`\`\`
src/av_studio/processing/audio/effects.py
tests/processing/audio/test_effects.py
\`\`\`

---

**ðŸ¤– Agent:** @copilot - Implement on \`dev\` branch  
**ðŸ“‹ Spec Reference:** [spec-kit_tasks.md](../blob/main/spec-kit_tasks.md)`
              },
              {
                id: 'AUD-004',
                title: '[AUD-004] Implement loudness normalization',
                phase: '4',
                priority: 'P1-high',
                type: 'type:feature',
                estimate: 2,
                dependencies: ['INFRA-001'],
                body: `## Task: AUD-004 - Implement loudness normalization

**Phase:** 4 - Audio Processing | **Priority:** P1-high | **Estimate:** 2 hours  
**Dependencies:** INFRA-001

---

### Description
Implement LUFS-based loudness normalization for streaming platforms.

### Acceptance Criteria
- [ ] Measure current LUFS loudness
- [ ] Normalize to configurable target LUFS (-14 default for streaming)
- [ ] True peak limiting
- [ ] Platform presets (Spotify, YouTube, Apple Music)

### Files to Create
\`\`\`
src/av_studio/processing/audio/normalization.py
tests/processing/audio/test_normalization.py
\`\`\`

---

**ðŸ¤– Agent:** @copilot - Implement on \`dev\` branch  
**ðŸ“‹ Spec Reference:** [spec-kit_tasks.md](../blob/main/spec-kit_tasks.md)`
              },
              {
                id: 'AUD-005',
                title: '[AUD-005] Implement audio format conversion',
                phase: '4',
                priority: 'P2-medium',
                type: 'type:feature',
                estimate: 2,
                dependencies: ['INFRA-001'],
                body: `## Task: AUD-005 - Implement audio format conversion

**Phase:** 4 - Audio Processing | **Priority:** P2-medium | **Estimate:** 2 hours  
**Dependencies:** INFRA-001

---

### Description
Implement audio format conversion between common formats.

### Acceptance Criteria
- [ ] Support: WAV, MP3, FLAC, AAC, OGG
- [ ] Quality presets (lossless, high, medium, low)
- [ ] Metadata preservation
- [ ] Batch conversion support

### Files to Create
\`\`\`
src/av_studio/processing/audio/converter.py
tests/processing/audio/test_converter.py
\`\`\`

---

**ðŸ¤– Agent:** @copilot - Implement on \`dev\` branch  
**ðŸ“‹ Spec Reference:** [spec-kit_tasks.md](../blob/main/spec-kit_tasks.md)`
              },
              {
                id: 'AUD-006',
                title: '[AUD-006] Implement unified audio pipeline',
                phase: '4',
                priority: 'P0-critical',
                type: 'type:feature',
                estimate: 3,
                dependencies: ['AUD-001', 'AUD-002', 'AUD-003', 'AUD-004', 'AUD-005'],
                body: `## Task: AUD-006 - Implement unified audio pipeline

**Phase:** 4 - Audio Processing | **Priority:** P0-critical | **Estimate:** 3 hours  
**Dependencies:** AUD-001 through AUD-005

---

### Description
Create a unified audio processing pipeline that orchestrates all audio operations.

### Acceptance Criteria
- [ ] Single entry point for all audio operations
- [ ] Batch processing support with configurable parallelism
- [ ] GPU memory management (load/unload models)
- [ ] Progress tracking and callbacks
- [ ] Error handling and recovery

### Files to Create
\`\`\`
src/av_studio/processing/audio/pipeline.py
tests/processing/audio/test_pipeline.py
\`\`\`

---

**ðŸ¤– Agent:** @copilot - Implement on \`dev\` branch  
**ðŸ“‹ Spec Reference:** [spec-kit_tasks.md](../blob/main/spec-kit_tasks.md)`
              },

              // ==================== PHASE 5: AGENT SYSTEM ====================
              {
                id: 'AGT-001',
                title: '[AGT-001] Implement base agent class',
                phase: '5',
                priority: 'P0-critical',
                type: 'type:feature',
                estimate: 4,
                dependencies: ['LLM-004'],
                body: `## Task: AGT-001 - Implement base agent class

**Phase:** 5 - Agent System | **Priority:** P0-critical | **Estimate:** 4 hours  
**Dependencies:** LLM-004

---

### Description
Create the base agent class that all specialized agents inherit from.

### Acceptance Criteria
- [ ] Abstract base with common functionality
- [ ] System prompt management
- [ ] Tool use capability (MCP integration ready)
- [ ] Memory/context management
- [ ] Logging and observability
- [ ] Async execution support

### Files to Create
\`\`\`
src/av_studio/agents/__init__.py
src/av_studio/agents/base_agent.py
tests/agents/test_base_agent.py
\`\`\`

### Reference Implementation
See: \`av_studio_src_agents_orchestrator.py\`

---

**ðŸ¤– Agent:** @copilot - Implement on \`dev\` branch  
**ðŸ“‹ Spec Reference:** [spec-kit_tasks.md](../blob/main/spec-kit_tasks.md)`
              },
              {
                id: 'AGT-002',
                title: '[AGT-002] Implement orchestrator agent',
                phase: '5',
                priority: 'P0-critical',
                type: 'type:feature',
                estimate: 8,
                dependencies: ['AGT-001'],
                body: `## Task: AGT-002 - Implement orchestrator agent

**Phase:** 5 - Agent System | **Priority:** P0-critical | **Estimate:** 8 hours  
**Dependencies:** AGT-001

---

### Description
Create the main orchestrator agent that coordinates all specialized agents.

### Acceptance Criteria
- [ ] Task decomposition from user requests
- [ ] Agent routing and assignment
- [ ] State machine for task lifecycle
- [ ] Result synthesis from multiple agents
- [ ] Error handling and recovery
- [ ] Multi-agent conversation support

### Files to Create
\`\`\`
src/av_studio/agents/orchestrator.py
tests/agents/test_orchestrator.py
\`\`\`

---

**ðŸ¤– Agent:** @copilot - Implement on \`dev\` branch  
**ðŸ“‹ Spec Reference:** [spec-kit_tasks.md](../blob/main/spec-kit_tasks.md)`
              },
              {
                id: 'AGT-003',
                title: '[AGT-003] Implement audio agent',
                phase: '5',
                priority: 'P0-critical',
                type: 'type:feature',
                estimate: 4,
                dependencies: ['AGT-001', 'AUD-006'],
                body: `## Task: AGT-003 - Implement audio agent

**Phase:** 5 - Agent System | **Priority:** P0-critical | **Estimate:** 4 hours  
**Dependencies:** AGT-001, AUD-006

---

### Description
Create a specialized agent for audio processing tasks.

### Acceptance Criteria
- [ ] Understands audio processing requests in natural language
- [ ] Maps requests to audio pipeline operations
- [ ] Handles multi-step audio workflows
- [ ] Reports progress and status
- [ ] Can explain its actions

### Files to Create
\`\`\`
src/av_studio/agents/audio_agent.py
tests/agents/test_audio_agent.py
\`\`\`

---

**ðŸ¤– Agent:** @copilot - Implement on \`dev\` branch  
**ðŸ“‹ Spec Reference:** [spec-kit_tasks.md](../blob/main/spec-kit_tasks.md)`
              },
              {
                id: 'AGT-004',
                title: '[AGT-004] Implement video agent',
                phase: '5',
                priority: 'P1-high',
                type: 'type:feature',
                estimate: 4,
                dependencies: ['AGT-001'],
                body: `## Task: AGT-004 - Implement video agent

**Phase:** 5 - Agent System | **Priority:** P1-high | **Estimate:** 4 hours  
**Dependencies:** AGT-001

---

### Description
Create a specialized agent for video processing tasks.

### Acceptance Criteria
- [ ] Understands video processing requests
- [ ] Frame extraction and scene detection
- [ ] Audio extraction coordination with audio agent
- [ ] Progress reporting

### Files to Create
\`\`\`
src/av_studio/agents/video_agent.py
tests/agents/test_video_agent.py
\`\`\`

---

**ðŸ¤– Agent:** @copilot - Implement on \`dev\` branch  
**ðŸ“‹ Spec Reference:** [spec-kit_tasks.md](../blob/main/spec-kit_tasks.md)`
              },
              {
                id: 'AGT-005',
                title: '[AGT-005] Implement agent memory system',
                phase: '5',
                priority: 'P1-high',
                type: 'type:feature',
                estimate: 4,
                dependencies: ['AGT-001'],
                body: `## Task: AGT-005 - Implement agent memory system

**Phase:** 5 - Agent System | **Priority:** P1-high | **Estimate:** 4 hours  
**Dependencies:** AGT-001

---

### Description
Create a memory system for agents to maintain context across conversations and tasks.

### Acceptance Criteria
- [ ] Short-term conversation memory
- [ ] Long-term vector memory using ChromaDB
- [ ] Semantic memory retrieval for context
- [ ] Memory pruning and summarization
- [ ] Cross-agent memory sharing (controlled)

### Files to Create
\`\`\`
src/av_studio/agents/memory.py
tests/agents/test_memory.py
\`\`\`

---

**ðŸ¤– Agent:** @copilot - Implement on \`dev\` branch  
**ðŸ“‹ Spec Reference:** [spec-kit_tasks.md](../blob/main/spec-kit_tasks.md)`
              },

              // ==================== PHASE 6: API LAYER ====================
              {
                id: 'API-001',
                title: '[API-001] Implement FastAPI application core',
                phase: '6',
                priority: 'P0-critical',
                type: 'type:feature',
                estimate: 3,
                dependencies: ['GW-004', 'GW-005'],
                body: `## Task: API-001 - Implement FastAPI application core

**Phase:** 6 - API Layer | **Priority:** P0-critical | **Estimate:** 3 hours  
**Dependencies:** GW-004, GW-005

---

### Description
Create the core FastAPI application with middleware, CORS, and error handling.

### Acceptance Criteria
- [ ] FastAPI app with CORS configuration
- [ ] Auth middleware integration
- [ ] Rate limiting middleware
- [ ] Health check endpoint (/health)
- [ ] OpenAPI documentation auto-generated
- [ ] Global error handling

### Files to Create
\`\`\`
src/av_studio/api/__init__.py
src/av_studio/api/main.py
src/av_studio/api/middleware.py
src/av_studio/api/exceptions.py
tests/api/test_main.py
\`\`\`

---

**ðŸ¤– Agent:** @copilot - Implement on \`dev\` branch  
**ðŸ“‹ Spec Reference:** [spec-kit_tasks.md](../blob/main/spec-kit_tasks.md)`
              },
              {
                id: 'API-002',
                title: '[API-002] Implement audio API endpoints',
                phase: '6',
                priority: 'P0-critical',
                type: 'type:feature',
                estimate: 4,
                dependencies: ['API-001', 'AUD-006'],
                body: `## Task: API-002 - Implement audio API endpoints

**Phase:** 6 - API Layer | **Priority:** P0-critical | **Estimate:** 4 hours  
**Dependencies:** API-001, AUD-006

---

### Description
Create REST API endpoints for audio processing operations.

### Acceptance Criteria
- [ ] POST /api/v1/audio/separate - stem separation
- [ ] POST /api/v1/audio/transcribe - speech-to-text
- [ ] POST /api/v1/audio/effects - apply effects
- [ ] POST /api/v1/audio/normalize - loudness normalization
- [ ] Async job handling with status polling
- [ ] File upload support

### Files to Create
\`\`\`
src/av_studio/api/routes/__init__.py
src/av_studio/api/routes/audio.py
src/av_studio/api/schemas/audio.py
tests/api/test_audio_routes.py
\`\`\`

---

**ðŸ¤– Agent:** @copilot - Implement on \`dev\` branch  
**ðŸ“‹ Spec Reference:** [spec-kit_tasks.md](../blob/main/spec-kit_tasks.md)`
              },
              {
                id: 'API-003',
                title: '[API-003] Implement LLM API endpoints',
                phase: '6',
                priority: 'P0-critical',
                type: 'type:feature',
                estimate: 3,
                dependencies: ['API-001', 'LLM-004'],
                body: `## Task: API-003 - Implement LLM API endpoints

**Phase:** 6 - API Layer | **Priority:** P0-critical | **Estimate:** 3 hours  
**Dependencies:** API-001, LLM-004

---

### Description
Create REST API endpoints for LLM interactions.

### Acceptance Criteria
- [ ] POST /api/v1/llm/chat - chat completion
- [ ] POST /api/v1/llm/stream - streaming chat (SSE)
- [ ] GET /api/v1/llm/models - list available models
- [ ] Integration with smart router

### Files to Create
\`\`\`
src/av_studio/api/routes/llm.py
src/av_studio/api/schemas/llm.py
tests/api/test_llm_routes.py
\`\`\`

---

**ðŸ¤– Agent:** @copilot - Implement on \`dev\` branch  
**ðŸ“‹ Spec Reference:** [spec-kit_tasks.md](../blob/main/spec-kit_tasks.md)`
              },
              {
                id: 'API-004',
                title: '[API-004] Implement agent API endpoints',
                phase: '6',
                priority: 'P0-critical',
                type: 'type:feature',
                estimate: 4,
                dependencies: ['API-001', 'AGT-002'],
                body: `## Task: API-004 - Implement agent API endpoints

**Phase:** 6 - API Layer | **Priority:** P0-critical | **Estimate:** 4 hours  
**Dependencies:** API-001, AGT-002

---

### Description
Create REST and WebSocket endpoints for agent interactions.

### Acceptance Criteria
- [ ] POST /api/v1/agents/task - submit task to orchestrator
- [ ] GET /api/v1/agents/task/{id} - get task status
- [ ] WebSocket /api/v1/agents/stream/{id} - real-time updates
- [ ] Multi-turn conversation support

### Files to Create
\`\`\`
src/av_studio/api/routes/agents.py
src/av_studio/api/schemas/agents.py
tests/api/test_agent_routes.py
\`\`\`

---

**ðŸ¤– Agent:** @copilot - Implement on \`dev\` branch  
**ðŸ“‹ Spec Reference:** [spec-kit_tasks.md](../blob/main/spec-kit_tasks.md)`
              },
              {
                id: 'API-005',
                title: '[API-005] Implement gateway API endpoints',
                phase: '6',
                priority: 'P1-high',
                type: 'type:feature',
                estimate: 2,
                dependencies: ['API-001', 'GW-002', 'GW-003'],
                body: `## Task: API-005 - Implement gateway API endpoints

**Phase:** 6 - API Layer | **Priority:** P1-high | **Estimate:** 2 hours  
**Dependencies:** API-001, GW-002, GW-003

---

### Description
Create REST API endpoints for gateway features (cost, routing, tokens).

### Acceptance Criteria
- [ ] GET /api/v1/gateway/cost - get cost summary
- [ ] POST /api/v1/gateway/analyze-tokens - token analysis
- [ ] POST /api/v1/gateway/route - get routing recommendation

### Files to Create
\`\`\`
src/av_studio/api/routes/gateway.py
src/av_studio/api/schemas/gateway.py
tests/api/test_gateway_routes.py
\`\`\`

---

**ðŸ¤– Agent:** @copilot - Implement on \`dev\` branch  
**ðŸ“‹ Spec Reference:** [spec-kit_tasks.md](../blob/main/spec-kit_tasks.md)`
              },

              // ==================== PHASE 7: MCP SERVER ====================
              {
                id: 'MCP-001',
                title: '[MCP-001] Implement MCP server core',
                phase: '7',
                priority: 'P1-high',
                type: 'type:feature',
                estimate: 4,
                dependencies: ['INFRA-001'],
                body: `## Task: MCP-001 - Implement MCP server core

**Phase:** 7 - MCP Server | **Priority:** P1-high | **Estimate:** 4 hours  
**Dependencies:** INFRA-001

---

### Description
Create the Model Context Protocol server for tool extension.

### Acceptance Criteria
- [ ] MCP server with stdio transport
- [ ] Tool registration system
- [ ] Resource serving capability
- [ ] Prompt template support
- [ ] Error handling

### Files to Create
\`\`\`
src/av_studio/mcp/__init__.py
src/av_studio/mcp/server.py
tests/mcp/test_server.py
\`\`\`

### Reference Implementation
See: \`av_studio_src_mcp_server.py\`

---

**ðŸ¤– Agent:** @copilot - Implement on \`dev\` branch  
**ðŸ“‹ Spec Reference:** [spec-kit_tasks.md](../blob/main/spec-kit_tasks.md)`
              },
              {
                id: 'MCP-002',
                title: '[MCP-002] Implement audio MCP tools',
                phase: '7',
                priority: 'P1-high',
                type: 'type:feature',
                estimate: 3,
                dependencies: ['MCP-001', 'AUD-006'],
                body: `## Task: MCP-002 - Implement audio MCP tools

**Phase:** 7 - MCP Server | **Priority:** P1-high | **Estimate:** 3 hours  
**Dependencies:** MCP-001, AUD-006

---

### Description
Create MCP tools for audio processing operations.

### Acceptance Criteria
- [ ] separate_stems tool
- [ ] transcribe_audio tool
- [ ] apply_effects tool
- [ ] normalize_loudness tool
- [ ] Proper input validation
- [ ] Error handling with helpful messages

### Files to Create
\`\`\`
src/av_studio/mcp/tools/__init__.py
src/av_studio/mcp/tools/audio_tools.py
tests/mcp/test_audio_tools.py
\`\`\`

---

**ðŸ¤– Agent:** @copilot - Implement on \`dev\` branch  
**ðŸ“‹ Spec Reference:** [spec-kit_tasks.md](../blob/main/spec-kit_tasks.md)`
              },
              {
                id: 'MCP-003',
                title: '[MCP-003] Implement gateway MCP tools',
                phase: '7',
                priority: 'P1-high',
                type: 'type:feature',
                estimate: 2,
                dependencies: ['MCP-001', 'GW-003'],
                body: `## Task: MCP-003 - Implement gateway MCP tools

**Phase:** 7 - MCP Server | **Priority:** P1-high | **Estimate:** 2 hours  
**Dependencies:** MCP-001, GW-003

---

### Description
Create MCP tools for gateway operations (cost, routing).

### Acceptance Criteria
- [ ] analyze_cost tool
- [ ] route_model tool  
- [ ] get_cost_summary tool

### Files to Create
\`\`\`
src/av_studio/mcp/tools/gateway_tools.py
tests/mcp/test_gateway_tools.py
\`\`\`

---

**ðŸ¤– Agent:** @copilot - Implement on \`dev\` branch  
**ðŸ“‹ Spec Reference:** [spec-kit_tasks.md](../blob/main/spec-kit_tasks.md)`
              }
            ];

            // ============================================================
            // FILTER BY PHASE IF SPECIFIED
            // ============================================================
            const tasksToCreate = phase === 'all' 
              ? allTasks 
              : allTasks.filter(t => t.phase === phase);

            console.log(`Creating ${tasksToCreate.length} issues for phase: ${phase}`);

            // ============================================================
            // GET PROJECT INFO VIA GRAPHQL
            // ============================================================
            const projectQuery = `
              query($login: String!, $number: Int!) {
                user(login: $login) {
                  projectV2(number: $number) {
                    id
                    fields(first: 20) {
                      nodes {
                        ... on ProjectV2Field {
                          id
                          name
                          dataType
                        }
                        ... on ProjectV2SingleSelectField {
                          id
                          name
                          options {
                            id
                            name
                          }
                        }
                      }
                    }
                  }
                }
              }
            `;

            let projectId, statusField, phaseField, priorityField, agentField;
            
            try {
              const projectData = await github.graphql(projectQuery, {
                login: process.env.PROJECT_OWNER,
                number: parseInt(process.env.PROJECT_NUMBER)
              });
              
              projectId = projectData.user.projectV2.id;
              const fields = projectData.user.projectV2.fields.nodes;
              
              statusField = fields.find(f => f.name?.toLowerCase() === 'status');
              phaseField = fields.find(f => f.name?.toLowerCase() === 'phase');
              priorityField = fields.find(f => f.name?.toLowerCase() === 'priority');
              agentField = fields.find(f => f.name?.toLowerCase() === 'agent');
              
              console.log('Project ID:', projectId);
              console.log('Fields found:', { statusField: !!statusField, phaseField: !!phaseField });
            } catch (e) {
              console.log('Could not fetch project fields:', e.message);
              console.log('Issues will be created but not added to project board');
            }

            // ============================================================
            // CREATE ISSUES AND ADD TO PROJECT
            // ============================================================
            for (const task of tasksToCreate) {
              try {
                // Create the issue
                const issue = await github.rest.issues.create({
                  owner: context.repo.owner,
                  repo: context.repo.repo,
                  title: task.title,
                  body: task.body,
                  labels: [task.priority, task.type, `phase:${task.phase}-${getPhaseNameByNumber(task.phase)}`, 'agent:coder']
                });
                
                console.log(`âœ… Created issue #${issue.data.number}: ${task.title}`);

                // Add to project if we have project info
                if (projectId) {
                  try {
                    const addResult = await github.graphql(`
                      mutation($projectId: ID!, $contentId: ID!) {
                        addProjectV2ItemById(input: {projectId: $projectId, contentId: $contentId}) {
                          item { id }
                        }
                      }
                    `, {
                      projectId: projectId,
                      contentId: issue.data.node_id
                    });
                    
                    console.log(`  ðŸ“‹ Added to project board`);
                  } catch (pe) {
                    console.log(`  âš ï¸ Could not add to project: ${pe.message}`);
                  }
                }
                
                // Small delay to avoid rate limiting
                await new Promise(r => setTimeout(r, 500));
                
              } catch (e) {
                console.error(`âŒ Failed to create ${task.id}: ${e.message}`);
              }
            }
            
            function getPhaseNameByNumber(num) {
              const names = {
                '1': 'foundation',
                '2': 'gateway', 
                '3': 'llm',
                '4': 'audio',
                '5': 'agents',
                '6': 'api',
                '7': 'mcp'
              };
              return names[num] || 'unknown';
            }
